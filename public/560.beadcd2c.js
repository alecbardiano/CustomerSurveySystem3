(self["webpackChunkcustomersurveymangementsystemsurvey"]=self["webpackChunkcustomersurveymangementsystemsurvey"]||[]).push([[560],{425:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>al});s(246);var t=s(3673),a=s(2323),n=s(8880);const i=e=>((0,t.dD)("data-v-7f110ffe"),e=e(),(0,t.Cn)(),e),o={class:"q-pa-md"},r={class:"row"},u={class:"q-pa-md"},d=(0,t.Uk)("Scan QR"),c={class:"row"},m={class:"q-pa-lg"},p=(0,t.Uk)(" Preferred verification: "),v={class:"row"},y={class:"q-pa-lg"},w={key:0,id:"legendPanel"},g=i((()=>(0,t._)("tr",null,[(0,t._)("th",{colspan:"2"},"Legend")],-1))),f=i((()=>(0,t._)("tr",null,[(0,t._)("th",null,"Rating"),(0,t._)("th",null,"Smiley")],-1))),h=i((()=>(0,t._)("th",null,"Poor - 1",-1))),b=i((()=>(0,t._)("th",null,"Fair - 2",-1))),_=i((()=>(0,t._)("th",null,"Satisfactory - 3",-1))),j=i((()=>(0,t._)("th",null,"Very Satisfactory - 4",-1))),k=i((()=>(0,t._)("th",null,"Excellent - 5",-1))),V={key:1},q={class:"row"},x={class:""},S={key:0},z={class:"row"},C={class:"questions"},Q={class:"row inline"},A={class:"inputs"},W={key:1},H={class:"questions"},D={class:"surveyquestions"},R=i((()=>(0,t._)("div",{class:"row inline>"},[(0,t._)("div",{class:"col-4"},[(0,t._)("h5",null,"Survey Questions")])],-1))),Z={class:"row"},N={class:"col-4 col-md-4"},F={class:"questions"},P={class:"row inline"},U={class:"inputs"},I={class:"row justify-end"},M={class:"text-h5 inline"},E=i((()=>(0,t._)("tr",null,[(0,t._)("th",null,"Questions"),(0,t._)("th",null,"Answers")],-1))),T={key:0,style:{"text-align":"left"}},B={key:1,style:{"text-align":"right"}},O={class:"row justify-center"},X=i((()=>(0,t._)("div",{class:"text-h6"},"How was your experience using the app?",-1))),Y=i((()=>(0,t._)("div",{class:"text-h6"},"Scan QR Code",-1))),$=(0,t.Uk)("Close"),L={class:"scan-confirmation"};function K(e,l,s,i,K,J){const G=(0,t.up)("q-input"),ee=(0,t.up)("q-tooltip"),le=(0,t.up)("q-btn"),se=(0,t.up)("q-option-group"),te=(0,t.up)("q-icon"),ae=(0,t.up)("CustomSurveyField"),ne=(0,t.up)("q-card-section"),ie=(0,t.up)("q-card-actions"),oe=(0,t.up)("q-card"),re=(0,t.up)("q-dialog"),ue=(0,t.up)("q-spinner-facebook"),de=(0,t.up)("q-form"),ce=(0,t.up)("q-rating"),me=(0,t.up)("q-space"),pe=(0,t.up)("qrcode-stream"),ve=(0,t.up)("q-page"),ye=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(ve,null,{default:(0,t.w5)((()=>[(0,t._)("div",o,[(0,t.Wm)(de,{onSubmit:e.onSubmit,class:"q-gutter-md",ref:"surveyRefForm"},{default:(0,t.w5)((()=>[(0,t._)("div",r,[(0,t._)("div",null,[(0,t.Wm)(G,{ref:"inputRef",filled:"","lazy-rules":"",rules:[e=>!!e||"Field is required",e=>/^[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}$/.test(e)||"Field should be a valid tsr number ex. XXX-XXX-XXX-XXX"],outlined:"",modelValue:e.TsrNo,"onUpdate:modelValue":l[0]||(l[0]=l=>e.TsrNo=l),label:"TSR Number",style:{width:"250px"},"stack-label":""},null,8,["rules","modelValue"])]),(0,t._)("div",null,[(0,t._)("div",u,[(0,t.Wm)(le,{round:"",color:"primary",onClick:l[1]||(l[1]=l=>e.showQRStream=!0),icon:"fas fa-qrcode"},{default:(0,t.w5)((()=>[(0,t.Wm)(ee,{class:"bg-white text-primary"},{default:(0,t.w5)((()=>[d])),_:1})])),_:1})])])]),(0,t._)("div",c,[(0,t._)("div",m,[p,(0,t.Wm)(se,{modelValue:e.group,"onUpdate:modelValue":l[2]||(l[2]=l=>e.group=l),options:e.options,color:"primary",inline:""},null,8,["modelValue","options"])])]),(0,t._)("div",v,[(0,t._)("div",y,[3==e.modeValidate?((0,t.wg)(),(0,t.j4)(G,{key:0,ref:"emailRef",filled:"","lazy-rules":"",rules:[e=>!!e||"Field is required",e=>/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)||"Field should be a valid email ex. xxxx@mail.com"],outlined:"",modelValue:e.emailCustomerValidate,"onUpdate:modelValue":l[3]||(l[3]=l=>e.emailCustomerValidate=l),label:e.selectedLabel,style:{width:"250px"},"stack-label":""},null,8,["rules","modelValue","label"])):1==e.modeValidate?((0,t.wg)(),(0,t.j4)(G,{key:1,ref:"emailRef",filled:"","lazy-rules":"",rules:[e=>!!e||"Field is required",e=>/^(09|\+639)\d{9}$/.test(e)||"Field should be a valid mobile number ex 09xxxxxxxxx or +639xxxxxxxxx"],outlined:"",modelValue:e.emailCustomerValidate,"onUpdate:modelValue":l[4]||(l[4]=l=>e.emailCustomerValidate=l),label:e.selectedLabel,style:{width:"250px"},"stack-label":""},null,8,["rules","modelValue","label"])):((0,t.wg)(),(0,t.j4)(G,{key:2,ref:"emailRef",filled:"","lazy-rules":"",rules:[e=>!!e||"Field is required",e=>/^\d{3}-\d{4}$/.test(e)||"Field should be a valid telephone number ex xxx-xxxx"],outlined:"",modelValue:e.emailCustomerValidate,"onUpdate:modelValue":l[5]||(l[5]=l=>e.emailCustomerValidate=l),label:e.selectedLabel,style:{width:"250px"},"stack-label":""},null,8,["rules","modelValue","label"]))])]),e.$q.platform.is.mobile?((0,t.wg)(),(0,t.iD)("div",V)):((0,t.wg)(),(0,t.iD)("div",w,[(0,t._)("table",null,[g,f,(0,t._)("tr",null,[h,(0,t._)("th",null,[(0,t.Wm)(te,{name:"sentiment_very_dissatisfied",size:"2.0em"})])]),(0,t._)("tr",null,[b,(0,t._)("th",null,[(0,t.Wm)(te,{name:"sentiment_dissatisfied",size:"2.0em"})])]),(0,t._)("tr",null,[_,(0,t._)("th",null,[(0,t.Wm)(te,{name:"sentiment_satisfied",size:"2.0em"})])]),(0,t._)("tr",null,[j,(0,t._)("th",null,[(0,t.Wm)(te,{name:"sentiment_satisfied_alt",size:"2.0em"})])]),(0,t._)("tr",null,[k,(0,t._)("th",null,[(0,t.Wm)(te,{name:"sentiment_very_satisfied",size:"2.0em"})])])])])),(0,t._)("div",q,[(0,t._)("div",x,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.orderByPositionQuestions,((l,s)=>((0,t.wg)(),(0,t.iD)("div",{key:l.question},[(0,t._)("div",null,[0==l.children.length?((0,t.wg)(),(0,t.iD)("div",S,[(0,t._)("div",z,[(0,t._)("p",C,(0,a.zw)(l.description),1)]),(0,t._)("div",Q,[(0,t._)("div",A,[3==l.id?((0,t.wg)(),(0,t.j4)(ae,{key:0,modelValue:e.surveyAnswer.answers[s],"onUpdate:modelValue":l=>e.surveyAnswer.answers[s]=l,questionId:l.id,question_type:l.question_type,labelval:l.label},null,8,["modelValue","onUpdate:modelValue","questionId","question_type","labelval"])):((0,t.wg)(),(0,t.j4)(ae,{key:1,modelValue:e.surveyAnswer.answers[s],"onUpdate:modelValue":l=>e.surveyAnswer.answers[s]=l,questionId:l.id,question_type:l.question_type,labelval:l.label},null,8,["modelValue","onUpdate:modelValue","questionId","question_type","labelval"]))])])])):l.children.length>0?((0,t.wg)(),(0,t.iD)("div",W,[(0,t._)("p",H,(0,a.zw)(l.description),1),(0,t._)("div",D,[R,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.orderByNestedSurveyQuestions(l.children),((l,n)=>((0,t.wg)(),(0,t.iD)("div",{class:"q-pa-md",key:l.id},[(0,t._)("div",Z,[(0,t._)("div",N,[(0,t._)("p",F,(0,a.zw)(n+1)+". "+(0,a.zw)(l.description),1)]),(0,t._)("div",P,[(0,t._)("div",U,[(0,t.Wm)(ae,{modelValue:e.subHeaderSurveyAnswer.answers[e.orderByPositionQuestions.slice(0,s).reduce(((e,l)=>e+l.children.length),0)+n],"onUpdate:modelValue":l=>e.subHeaderSurveyAnswer.answers[e.orderByPositionQuestions.slice(0,s).reduce(((e,l)=>e+l.children.length),0)+n]=l,questionId:l.id,question_type:l.question_type,labelval:l.label},null,8,["modelValue","onUpdate:modelValue","questionId","question_type","labelval"])]),(0,t._)("div",null,[e.subHeaderSurveyAnswer.answers[e.orderByPositionQuestions.slice(0,s).reduce(((e,l)=>e+l.children.length),0)+n].value<3&&""!=e.subHeaderSurveyAnswer.answers[e.orderByPositionQuestions.slice(0,s).reduce(((e,l)=>e+l.children.length),0)+n].value?((0,t.wg)(),(0,t.j4)(G,{key:0,modelValue:e.subHeaderSurveyAnswer.answers[e.orderByPositionQuestions.slice(0,s).reduce(((e,l)=>e+l.children.length),0)+n].remarks,"onUpdate:modelValue":l=>e.subHeaderSurveyAnswer.answers[e.orderByPositionQuestions.slice(0,s).reduce(((e,l)=>e+l.children.length),0)+n].remarks=l,outlined:"",label:"Remarks:",style:{width:"300px"},"stack-label":"","lazy-rules":"",rules:[e=>!!e||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","rules"])):(0,t.kq)("",!0)])])])])))),128))])])):(0,t.kq)("",!0)])])))),128))])]),(0,t._)("div",I,[(0,t.Wm)(re,{modelValue:e.prompt,"onUpdate:modelValue":l[6]||(l[6]=l=>e.prompt=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(oe,{style:{"min-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(ne,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t._)("div",M,[(0,t._)("span",null,"Please Confirm Answers for TSR Number: "+(0,a.zw)(e.TsrNo),1)])])),_:1}),(0,t.Wm)(ne,{class:"row items-left"},{default:(0,t.w5)((()=>[(0,t._)("table",null,[E,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.iD)("tr",{key:l.id},[void 0!=e.answer.value?((0,t.wg)(),(0,t.iD)("td",T,(0,a.zw)(l.description),1)):(0,t.kq)("",!0),void 0!=e.answer.value?((0,t.wg)(),(0,t.iD)("td",B,(0,a.zw)(l.value),1)):(0,t.kq)("",!0)])))),128))])])),_:1}),(0,t.Wm)(ie,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(le,{flat:"",label:"Cancel",color:"primary"},null,512),[[ye]]),(0,t.wy)((0,t.Wm)(le,{flat:"",label:"Submit",onClick:e.onSubmit,color:"primary"},null,8,["onClick"]),[[ye]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,t._)("div",O,[(0,t.Wm)(le,{label:"Reset Form",class:"q-ma-sm",color:"primary",onClick:e.clearFields},null,8,["onClick"]),(0,t.Wm)(le,{class:"q-ma-sm",color:"primary",label:"Submit",onClick:e.confirmModalShow},{loading:(0,t.w5)((()=>[(0,t.Wm)(ue)])),_:1},8,["onClick"])])])),_:1},8,["onSubmit"])]),(0,t.Wm)(re,{modelValue:e.feedbackAfter,"onUpdate:modelValue":l[10]||(l[10]=l=>e.feedbackAfter=l),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(oe,{style:{"min-width":"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(ne,null,{default:(0,t.w5)((()=>[X])),_:1}),(0,t.Wm)(ne,{class:"row justify-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(ce,{modelValue:e.ratingApp.value,"onUpdate:modelValue":l[7]||(l[7]=l=>e.ratingApp.value=l),size:"3.5em",color:"primary",icon:"star_border"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(ne,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(G,{dense:"",modelValue:e.ratingApp.remarks,"onUpdate:modelValue":l[8]||(l[8]=l=>e.ratingApp.remarks=l),autofocus:"",onKeyup:l[9]||(l[9]=(0,n.D2)((l=>e.prompt=!1),["enter"]))},null,8,["modelValue"]),[[n.F8,e.ratingApp.value<=2&&e.ratingApp.value>0]])])),_:1}),(0,t.Wm)(ie,{align:"right",class:"text-primary"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(le,{flat:"",label:"Submit",onClick:e.submitRateAppSurvey},null,8,["onClick"]),[[ye]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(re,{modelValue:e.showQRStream,"onUpdate:modelValue":l[11]||(l[11]=l=>e.showQRStream=l)},{default:(0,t.w5)((()=>[(0,t.Wm)(oe,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(ne,{class:"row items-center bg-primary text-white"},{default:(0,t.w5)((()=>[Y,(0,t.Wm)(me),(0,t.wy)(((0,t.wg)(),(0,t.j4)(le,{class:"float-right",dense:"",flat:"",icon:"close"},{default:(0,t.w5)((()=>[(0,t.Wm)(ee,{class:"bg-white text-primary"},{default:(0,t.w5)((()=>[$])),_:1})])),_:1})),[[ye]])])),_:1}),(0,t.Wm)(ne,{class:"bg-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(pe,{camera:e.camera,onDecode:e.onDecode,onInit:e.onInit},{default:(0,t.w5)((()=>[(0,t.wy)((0,t._)("div",L,null,512),[[n.F8,e.showScanConfirmation]])])),_:1},8,["camera","onDecode","onInit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}s(71);var J=s(8825),G=s(1959);const ee={key:0},le={key:1},se={key:2};function te(e,l,s,n,i,o){const r=(0,t.up)("q-input"),u=(0,t.up)("q-tooltip"),d=(0,t.up)("q-rating");return 1==s.question_type?((0,t.wg)(),(0,t.iD)("div",ee,[(0,t.Wm)(r,{outlined:"",modelValue:n.inputViewModel,"onUpdate:modelValue":l[0]||(l[0]=e=>n.inputViewModel=e),label:s.labelval,style:{width:"500px"},"stack-label":""},null,8,["modelValue","label"])])):12==n.props.questionId?((0,t.wg)(),(0,t.iD)("div",le,[(0,t.Wm)(d,{modelValue:n.inputViewModel,"onUpdate:modelValue":l[1]||(l[1]=e=>n.inputViewModel=e),name:"answerRating",max:5,size:"3.0em",color:"grey","lazy-rules":"",rules:[e=>""==e||"Field is required"],"color-selected":[[n.colorRate(n.inputViewModel),"grey","grey","grey","grey"],["grey",n.colorRate(n.inputViewModel),"grey","grey","grey"],["grey","grey",n.colorRate(n.inputViewModel),"grey","grey"],["grey","grey","grey",n.colorRate(n.inputViewModel),"grey"],["grey","grey","grey","grey",n.colorRate(n.inputViewModel)]][n.inputViewModel?n.inputViewModel-1:0],icon:["sentiment_very_dissatisfied","sentiment_dissatisfied","sentiment_satisfied","sentiment_satisfied_alt","sentiment_very_satisfied"]},(0,t.Nv)({_:2},[(0,t.Ko)(n.rateDefinitions,((e,l)=>({name:`tip-${l+1}`,fn:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(e),1)])),_:2},1024)]))})))]),1032,["modelValue","rules","color-selected"])])):2==s.question_type?((0,t.wg)(),(0,t.iD)("div",se,[(0,t.Wm)(d,{modelValue:n.inputViewModel,"onUpdate:modelValue":l[2]||(l[2]=e=>n.inputViewModel=e),max:5,size:"3.0em",color:"grey","color-selected":[[n.colorRate(n.inputViewModel),"grey","grey","grey","grey"],["grey",n.colorRate(n.inputViewModel),"grey","grey","grey"],["grey","grey",n.colorRate(n.inputViewModel),"grey","grey"],["grey","grey","grey",n.colorRate(n.inputViewModel),"grey"],["grey","grey","grey","grey",n.colorRate(n.inputViewModel)]][n.inputViewModel?n.inputViewModel-1:0],icon:["sentiment_very_dissatisfied","sentiment_dissatisfied","sentiment_satisfied","sentiment_satisfied_alt","sentiment_very_satisfied"]},(0,t.Nv)({_:2},[(0,t.Ko)(n.rateDefinitions,((e,l)=>({name:`tip-${l+1}`,fn:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(e),1)])),_:2},1024)]))})))]),1032,["modelValue","color-selected"])])):(0,t.kq)("",!0)}const ae={props:{modelValue:Object,question_type:Number,optionval:Array,labelval:String,questionId:Number},setup(e,{emit:l}){function s(){l("update:modelValue",{...e.modelValue,question:e.questionId})}(0,t.bv)((()=>{s()}));const a=(0,t.Fl)({get:()=>2==e.question_type?e.modelValue?parseInt(e.modelValue.value):0:e.modelValue?e.modelValue.value:"",set:s=>{if(!s)return null;l("update:modelValue",{...e.modelValue,value:s.toString()})}});function n(e){return["negative","deep-orange","positive","secondary","orange"][+e-1]}const i=["Poor","Fair","Satisfactory","Very Satisfactory","Outstanding"];return{inputViewModel:a,props:e,colorRate:n,rateDefinitions:i}}};var ne=s(4260),ie=s(4842),oe=s(8833),re=s(8870),ue=s(1504),de=s(7518),ce=s.n(de);const me=(0,ne.Z)(ae,[["render",te]]),pe=me;ce()(ae,"components",{QInput:ie.Z,QRating:oe.Z,QTooltip:re.Z,QSelect:ue.Z});var ve=s(5474),ye=s(1488),we=s.n(ye),ge=(s(8603),s(4259));let fe=new Date,he=(we()().year(),fe);const be=async e=>await ve.api.get("tsrs/getTsrSystems/"+e).then((function(e){return e.data}));let _e;const je=async function(e,l,s,t,a,n,i,o){let r,u,d,c=200,m=0,p=(0,ge.Z)();try{r=i||he;let v={tsrNo:s,industry:t,service:a,division:n,submittedAt:r,uuid:p};if(await ve.api.post("/tsrs",v).then((e=>{u=e.data.id,d=e.data})).catch((function(e){console.log(e.response.status),e.response?(console.log(e.response.status),console.log(e.response.headers),_e=e.response.status):e.request?console.log(e.request):console.log("Error",e.message)})),_e)return _e;for(const l of e)if(console.log("tsrsrsts",u),""!=l.question){let e={tsr:u,question:l.question,value:l.value,tsr_q_id:u+"_"+l.question,tsrNo:s},t=parseInt(e.value);t<=2&&(m=1),await ve.api.post("/answers",e)}for(const e of l){console.log("tsrsrsts",u);let l={tsr:u,question:e.question,value:e.value,tsr_q_id:u+"_"+e.question,tsrNo:s,remarks:e.remarks},t=parseInt(l.value);t<=2&&(m=1),await ve.api.post("/answers",l)}return 1==m&&await Ve(d,o),c}catch(v){console.log(v)}},ke=function(){return ve.api.get("/questions/withoutAns").then((function(e){return e.data}))},Ve=async function(e,l){let s=e.tsrNo,t=e.uuid;return console.log("tsr",e),await ve.api.get("/tsrs/sendEmailResolution/"+s+"/"+t+"/"+l)},qe=(e,l,s,t,a,n,i,o)=>je(e,l,s,t,a,n,i,o),xe=(e,l,s)=>ve.api.get("/tsrs/validateSurvey/"+e+"/"+l+"/"+s).then((function(e){return e.data})),Se=e=>ve.api.get("/tsrs/countMaxDiv/"+e).then((function(e){return e.data})),ze=()=>ke(),Ce=e=>(e.value=e.value.toString(),ve.api.post("/ratings/",e).then((function(e){return e.data}))),Qe=e=>((0,t.dD)("data-v-4142a666"),e=e(),(0,t.Cn)(),e),Ae={class:"text-h6 inline"},We={class:"justify-end"},He=Qe((()=>(0,t._)("tr",null,[(0,t._)("th",null,"Questions"),(0,t._)("th",null,"Answers")],-1))),De={style:{"text-align":"left"}},Re={style:{"text-align":"right"}};function Ze(e,l,s,n,i,o){const r=(0,t.up)("q-card-section"),u=(0,t.up)("q-btn"),d=(0,t.up)("q-card-actions"),c=(0,t.up)("q-card"),m=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Uk)((0,a.zw)(e.props)+" ",1),(0,t.Wm)(c,{style:{"min-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t._)("div",Ae,[(0,t.Uk)(" TSR No. "+(0,a.zw)(e.modelValue.value.tsrNo)+" ",1),(0,t._)("div",We,(0,a.zw)(e.modelValue.value.publishedDate),1)])])),_:1}),(0,t.Wm)(r,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t._)("table",null,[He,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.headerArray,(e=>((0,t.wg)(),(0,t.iD)("tr",{key:e.field},[(0,t._)("td",De,(0,a.zw)(e.name),1),(0,t._)("td",Re,(0,a.zw)(e.value),1)])))),128))])])),_:1}),(0,t.Wm)(d,{align:"right",class:"text-primary"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(u,{flat:"",label:"Close"},null,512),[[m]])])),_:1})])),_:1})])}s(2100);const Ne=(0,t.aZ)({props:{modelValue:Object,cols:Array},setup(e){let l=e.cols.map((({align:e,sortable:l,label:s,...t})=>t));console.log("header",l);let s=(0,G.iH)([]),a=(0,G.iH)({}),n=JSON.parse(JSON.stringify(e.modelValue.value));for(var i in console.log("ANSWERRR",n),n)for(let e=0;e<l.length;e++)if(i==l[e].field){l[e].value=n[i]}return(0,t.bv)((()=>{console.log("onmounted"),console.log("cols"),console.log(l),console.log(e.modelValue.value)})),{headerArray:l,forArraySurveyDetails:s,surveyDetail:a}}});var Fe=s(151),Pe=s(5589),Ue=s(9367),Ie=s(8240),Me=s(677);const Ee=(0,ne.Z)(Ne,[["render",Ze],["__scopeId","data-v-4142a666"]]),Te=Ee;ce()(Ne,"components",{QCard:Fe.Z,QCardSection:Pe.Z,QCardActions:Ue.Z,QBtn:Ie.Z}),ce()(Ne,"directives",{ClosePopup:Me.Z});var Be=s(4334),Oe=s.n(Be),Xe=s(4626);const Ye=(0,t.aZ)({name:"Survey",components:{CustomSurveyField:pe,QrcodeStream:Xe.QrcodeStream},setup(){let e;console.log("QrcodeStream",Xe.QrcodeStream);const l=(0,G.iH)(!1),s=(0,G.iH)("auto"),a=(0,G.iH)(null),n=(0,G.iH)(!1),i=(0,J.Z)(),o=(0,G.iH)(null),r=(0,G.iH)([]),u=((0,G.iH)([]),(0,G.iH)(null)),d=(0,G.iH)(0),c=(0,G.iH)(null),m=(0,G.iH)(null),p=(0,G.iH)(null),v=(0,G.iH)(null),y=(0,G.iH)(null),w=(0,G.iH)(null),g=(0,G.iH)(!1),f=((0,G.iH)(null),(0,G.iH)(null)),h=(0,G.iH)("mobileNumber"),b=(0,G.iH)(1),_=(0,G.iH)("Mobile Number"),j=[{label:"Mobile Number",value:"mobileNumber"},{label:"Telephone Number",value:"telNumber"},{label:"Email",value:"email"}],k=(0,G.iH)({value:"",remarks:""});(0,t.YP)(h,((e,l)=>{let s;switch(e){case"mobileNumber":s="Mobile Number",b.value=1;break;case"telNumber":s="Telephone Number",b.value=2;break;case"email":b.value=3,s="Email";break;default:break}c.value="",_.value=s})),(0,t.YP)(m,((e,l)=>{const s=/^[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}$/;s.test(e)&&H(e)}));const V=(0,G.iH)(!1),q=(0,G.iH)(!1),x=(0,G.iH)([]);let S=0;const z=(0,G.iH)([]),C=(0,G.qj)({answerid:"",value:"",question:"",tsrNo:"",remarks:""}),Q=(0,G.qj)({answers:[]}),A=(0,G.qj)({answers:[]}),W=(0,G.iH)("position"),H=async e=>{f.value=await be(e),f.value&&(v.value=f.value.indusry,p.value=f.value.service,w.value=f.value.sectionCode,y.value=f.value.division)},D=async()=>{try{r.value=await ze(),r.value=Oe()(r.value,W.value),x.value=r.value.filter((e=>(e.children=r.value.filter((l=>l.parent===e.id)),null===e.parent))),console.log("questions.value.",r.value),z.value=[...new Set(r.value.map((({id:e,description:l,value:s})=>({id:e,description:l,value:s}))))],x.value.forEach((e=>{e.children.forEach((e=>{S++,r.value.forEach(((l,s)=>{e.id==l.id&&r.value.splice(s,1)}))}))})),d.value=r.value.length,E(),u.value=!1}catch(e){throw e}},R=(0,t.Fl)((()=>Oe()(x.value,W.value)));function Z(){i.loading.show({message:"Please wait for data to be submitted..",boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"})}function N(){e=void 0,i.loading.hide()}function F(e){return Oe()(e,W.value)}function P(){V.value=!0;for(let e=0;e<Q.answers.length;e++){Q.answers[e].tsrNo=m.value;for(let l=0;l<z.value.length;l++)z.value[l].id==Q.answers[e].question&&(z.value[l].value=Q.answers[e].value)}for(let e=0;e<S;e++){A.answers[e].tsrNo=m.value;for(let l=0;l<z.value.length;l++)z.value[l].id==A.answers[e].question&&(z.value[l].value=A.answers[e].value)}}function U(){m.value="",c.value="",Q.answers.forEach((e=>{e.remarks="",e.value=""})),A.answers.forEach((e=>{e.remarks="",e.value=""})),o.value.reset()}async function I(){k.value&&await Ce(k.value)}async function M(){v.value&&""!=v.value||(v.value="");let e=["ATD"],l=!0;e.forEach((async e=>{e==y.value&&(l=await Se(y.value))}));let s=await xe(c.value,m.value,b.value);if("403"==s&&i.notify({color:"red-5",textColor:"white",icon:"warning",message:"You are not authorized to submit a survey "}),"400"==s)i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Duplicate TSR"});else if("403"==l)i.notify({color:"red-5",textColor:"white",icon:"warning",message:"You are not authorized to submit a survey "});else if(s&&l)if(f.value.industry&&""!=f.value.industry){Z();let e=await qe(Q.answers,A.answers,m.value,f.value.industry,f.value.service,f.value.division,"",c.value);console.log("aaaaa",e),"200"==e?(U(),N(),i.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Submitted"}),g.value=!0):"401"==e||"404"==e?(N(),i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Error in submitting Form, Please check connection"})):"500"==e&&(N(),i.notify({color:"red-5",textColor:"white",icon:"warning",message:"TSR-No is Duplicate"}))}else i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Industry is empty"});else i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Verification error"})}function E(){for(let e=0;e<d.value;e++)Q.answers.push(C);for(let e=0;e<S;e++)A.answers.push(C)}async function T(){o.value.validate().then((e=>{if(f.value)if(Object.keys(f.value).length)if(e){let e=A.answers.find((e=>12==e.question));e.value||""!=e.value?M():i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Please answer Overall Rating Question"})}else i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Please check all the fields"});else i.notify({color:"red-5",textColor:"white",icon:"warning",message:"TSR not Found"});else i.notify({color:"red-5",textColor:"white",icon:"warning",message:"Please check all the fields"})}))}async function B(e){try{await e}catch(t){console.error(t)}finally{l.value="off"===s.value}}async function O(e){/^[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}-[a-zA-Z0-9_]{0,8}$/.test(e)?(m.value=e,n.value=!1):i.notify({color:"red-5",textColor:"white",icon:"warning",message:"QR invalid"}),Y(),await $(500),X()}function X(){s.value="auto"}function Y(){s.value="off"}function $(e){return new Promise((l=>{window.setTimeout(l,e)}))}return(0,t.Jd)((()=>{void 0!==e&&(clearTimeout(e),i.loading.hide())})),(0,t.bv)((()=>{D(),E()})),{surveyRefForm:o,feedbackAfter:g,ratingApp:k,service:(0,G.iH)(null),industry:(0,G.iH)(null),comments:(0,G.iH)(null),TsrNo:m,emailCustomerValidate:c,CustomSurveyField:pe,getAllQuestionsFromApi:D,submitSurvey:M,orderByPositionQuestions:R,orderByNestedSurveyQuestions:F,surveyAnswer:Q,subHeaderSurveyAnswer:A,answer:C,questions:r,onSubmit:T,prompt:V,displayQuestions:x,confirmFlag:q,viewsurveyanswer:Te,confirmModalShow:P,cols:z,serviceData:p,industryData:v,divData:y,sectionData:w,clearFields:U,submitRateAppSurvey:I,showLoading:Z,group:h,options:j,selectedLabel:_,modeValidate:b,onDecode:O,QrcodeStream:Xe.QrcodeStream,showScanConfirmation:l,camera:s,result:a,onInit:B,showQRStream:n}}});let $e=0;document.addEventListener("scroll",(function(){var e=window.pageYOffset||document.documentElement.scrollTop;e>$e?(document.getElementById("legendPanel").style.visibility="hidden",document.getElementById("legendPanel").style.opacity="0",document.getElementById("legendPanel").style.transition="visibility 0s, opacity 0.5s linear"):(document.getElementById("legendPanel").style.visibility="visible",document.getElementById("legendPanel").style.opacity="1",document.getElementById("legendPanel").style.transition="visibility 0s, opacity 0.5s linear"),$e=e<=0?0:e}),!1);var Le=s(4379),Ke=s(5269),Je=s(4140),Ge=s(4554),el=s(6778),ll=s(8719),sl=s(2025);const tl=(0,ne.Z)(Ye,[["render",K],["__scopeId","data-v-7f110ffe"]]),al=tl;ce()(Ye,"components",{QPage:Le.Z,QForm:Ke.Z,QInput:ie.Z,QBtn:Ie.Z,QTooltip:re.Z,QOptionGroup:Je.Z,QIcon:Ge.Z,QDialog:el.Z,QCard:Fe.Z,QCardSection:Pe.Z,QCardActions:Ue.Z,QSpinnerFacebook:ll.Z,QRating:oe.Z,QSpace:sl.Z}),ce()(Ye,"directives",{ClosePopup:Me.Z})},6700:(e,l,s)=>{var t={"./af":5809,"./af.js":5809,"./ar":6069,"./ar-dz":481,"./ar-dz.js":481,"./ar-kw":3994,"./ar-kw.js":3994,"./ar-ly":3312,"./ar-ly.js":3312,"./ar-ma":239,"./ar-ma.js":239,"./ar-sa":1863,"./ar-sa.js":1863,"./ar-tn":9607,"./ar-tn.js":9607,"./ar.js":6069,"./az":9281,"./az.js":9281,"./be":9945,"./be.js":9945,"./bg":9384,"./bg.js":9384,"./bm":1476,"./bm.js":1476,"./bn":3345,"./bn-bd":216,"./bn-bd.js":216,"./bn.js":3345,"./bo":1713,"./bo.js":1713,"./br":9655,"./br.js":9655,"./bs":7296,"./bs.js":7296,"./ca":3049,"./ca.js":3049,"./cs":8393,"./cs.js":8393,"./cv":8039,"./cv.js":8039,"./cy":5563,"./cy.js":5563,"./da":1960,"./da.js":1960,"./de":7533,"./de-at":6674,"./de-at.js":6674,"./de-ch":7732,"./de-ch.js":7732,"./de.js":7533,"./dv":8343,"./dv.js":8343,"./el":7004,"./el.js":7004,"./en-au":2517,"./en-au.js":2517,"./en-ca":4929,"./en-ca.js":4929,"./en-gb":9722,"./en-gb.js":9722,"./en-ie":6923,"./en-ie.js":6923,"./en-il":8050,"./en-il.js":8050,"./en-in":9624,"./en-in.js":9624,"./en-nz":540,"./en-nz.js":540,"./en-sg":4375,"./en-sg.js":4375,"./eo":40,"./eo.js":40,"./es":9720,"./es-do":5595,"./es-do.js":5595,"./es-mx":180,"./es-mx.js":180,"./es-us":1563,"./es-us.js":1563,"./es.js":9720,"./et":9217,"./et.js":9217,"./eu":9474,"./eu.js":9474,"./fa":5243,"./fa.js":5243,"./fi":7645,"./fi.js":7645,"./fil":5350,"./fil.js":5350,"./fo":5622,"./fo.js":5622,"./fr":1467,"./fr-ca":3439,"./fr-ca.js":3439,"./fr-ch":4335,"./fr-ch.js":4335,"./fr.js":1467,"./fy":6026,"./fy.js":6026,"./ga":2969,"./ga.js":2969,"./gd":1347,"./gd.js":1347,"./gl":1085,"./gl.js":1085,"./gom-deva":904,"./gom-deva.js":904,"./gom-latn":9597,"./gom-latn.js":9597,"./gu":8705,"./gu.js":8705,"./he":9128,"./he.js":9128,"./hi":2821,"./hi.js":2821,"./hr":9002,"./hr.js":9002,"./hu":4814,"./hu.js":4814,"./hy-am":658,"./hy-am.js":658,"./id":9344,"./id.js":9344,"./is":8204,"./is.js":8204,"./it":376,"./it-ch":1549,"./it-ch.js":1549,"./it.js":376,"./ja":9293,"./ja.js":9293,"./jv":6401,"./jv.js":6401,"./ka":482,"./ka.js":482,"./kk":7329,"./kk.js":7329,"./km":4241,"./km.js":4241,"./kn":3566,"./kn.js":3566,"./ko":2742,"./ko.js":2742,"./ku":2915,"./ku.js":2915,"./ky":6846,"./ky.js":6846,"./lb":4959,"./lb.js":4959,"./lo":2188,"./lo.js":2188,"./lt":8967,"./lt.js":8967,"./lv":1245,"./lv.js":1245,"./me":751,"./me.js":751,"./mi":7501,"./mi.js":7501,"./mk":1643,"./mk.js":1643,"./ml":5597,"./ml.js":5597,"./mn":7612,"./mn.js":7612,"./mr":9065,"./mr.js":9065,"./ms":4703,"./ms-my":4645,"./ms-my.js":4645,"./ms.js":4703,"./mt":4365,"./mt.js":4365,"./my":3788,"./my.js":3788,"./nb":7357,"./nb.js":7357,"./ne":9109,"./ne.js":9109,"./nl":3746,"./nl-be":1985,"./nl-be.js":1985,"./nl.js":3746,"./nn":7175,"./nn.js":7175,"./oc-lnc":566,"./oc-lnc.js":566,"./pa-in":2733,"./pa-in.js":2733,"./pl":182,"./pl.js":182,"./pt":505,"./pt-br":7839,"./pt-br.js":7839,"./pt.js":505,"./ro":9578,"./ro.js":9578,"./ru":2328,"./ru.js":2328,"./sd":641,"./sd.js":641,"./se":1758,"./se.js":1758,"./si":6680,"./si.js":6680,"./sk":5016,"./sk.js":5016,"./sl":7424,"./sl.js":7424,"./sq":8635,"./sq.js":8635,"./sr":9038,"./sr-cyrl":3716,"./sr-cyrl.js":3716,"./sr.js":9038,"./ss":4771,"./ss.js":4771,"./sv":3517,"./sv.js":3517,"./sw":9419,"./sw.js":9419,"./ta":5959,"./ta.js":5959,"./te":1739,"./te.js":1739,"./tet":2264,"./tet.js":2264,"./tg":4792,"./tg.js":4792,"./th":8328,"./th.js":8328,"./tk":702,"./tk.js":702,"./tl-ph":7814,"./tl-ph.js":7814,"./tlh":797,"./tlh.js":797,"./tr":6691,"./tr.js":6691,"./tzl":6891,"./tzl.js":6891,"./tzm":6362,"./tzm-latn":7855,"./tzm-latn.js":7855,"./tzm.js":6362,"./ug-cn":7606,"./ug-cn.js":7606,"./uk":513,"./uk.js":513,"./ur":3803,"./ur.js":3803,"./uz":344,"./uz-latn":8957,"./uz-latn.js":8957,"./uz.js":344,"./vi":3,"./vi.js":3,"./x-pseudo":8842,"./x-pseudo.js":8842,"./yo":2083,"./yo.js":2083,"./zh-cn":4536,"./zh-cn.js":4536,"./zh-hk":2475,"./zh-hk.js":2475,"./zh-mo":1515,"./zh-mo.js":1515,"./zh-tw":4746,"./zh-tw.js":4746};function a(e){var l=n(e);return s(l)}function n(e){if(!s.o(t,e)){var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}return t[e]}a.keys=function(){return Object.keys(t)},a.resolve=n,e.exports=a,a.id=6700}}]);