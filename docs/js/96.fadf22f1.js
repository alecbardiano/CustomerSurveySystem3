"use strict";(self["webpackChunkcustomersurveysystem3"]=self["webpackChunkcustomersurveysystem3"]||[]).push([[96],{57096:(e,t,l)=>{l.r(t),l.d(t,{default:()=>I});var o=l(83673),i=l(62323);const a={class:"row justify-end"},n={class:"q-pa-md row items-start q-gutter-md"},u={class:"q-pa-md"},s={key:0},d=(0,o._)("div",{class:"text-h6"},"Add Question",-1),r={class:"q-pa-md"},p={key:0},c=(0,o._)("div",{class:"text-h6"},"Update Question",-1),m={class:"q-pa-md"},b={key:0},f=(0,o._)("div",{class:"text-h6"},"Please confirm",-1),y=(0,o._)("span",null,"Are you sure you want to delete this question?",-1),v={style:{"font-size":"18px",color:"red"}},h={key:0};function w(e,t,l,w,g,q){const Q=(0,o.up)("q-btn"),V=(0,o.up)("q-icon"),_=(0,o.up)("q-input"),W=(0,o.up)("q-td"),H=(0,o.up)("q-table"),k=(0,o.up)("q-card-section"),P=(0,o.up)("q-toggle"),x=(0,o.up)("q-select"),C=(0,o.up)("q-card-actions"),D=(0,o.up)("q-card"),T=(0,o.up)("q-form"),S=(0,o.up)("q-dialog"),U=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",a,[(0,o._)("div",n,[(0,o.Wm)(Q,{type:"submit",label:"Add Question",class:"q-mt-md",color:"primary",onClick:t[0]||(t[0]=t=>e.addQuestionClick())})])]),(0,o._)("div",u,[(0,o.Wm)(H,{title:"Questions",rows:e.rows,columns:e.columns,"row-key":"id",loading:e.loading,filter:e.filter,pagination:e.pagination,"onUpdate:pagination":t[2]||(t[2]=t=>e.pagination=t),onRequest:e.onRequest,"binary-state-sort":"",class:"my-sticky-header-table",separator:"cell"},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(_,{class:"placeholderClass",borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filter=t),placeholder:"Search"},{append:(0,o.w5)((()=>[(0,o.Wm)(V,{class:"searchClass",name:"search"})])),_:1},8,["modelValue"])])),"body-cell-action":(0,o.w5)((t=>[(0,o.Wm)(W,{props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{dense:"",round:"",flat:"",color:"grey",onClick:l=>e.editQuestion(t),icon:"edit"},null,8,["onClick"]),t.key>14?((0,o.wg)(),(0,o.j4)(Q,{key:0,dense:"",round:"",flat:"",color:"grey",onClick:l=>e.deleteQuestion(t),icon:"delete"},null,8,["onClick"])):(0,o.kq)("",!0)])),_:2},1032,["props"])])),_:1},8,["rows","columns","loading","filter","pagination","onRequest"])]),(0,o.Wm)(S,{modelValue:e.addQuestionModal,"onUpdate:modelValue":t[9]||(t[9]=t=>e.addQuestionModal=t)},{default:(0,o.w5)((()=>[e.addQuestionModal?((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(T,{ref:"questionForm",onSubmit:e.onSubmit},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{style:{"min-width":"500px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{class:"bg-primary text-white"},{default:(0,o.w5)((()=>[d])),_:1}),(0,o.Wm)(k,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o._)("div",r,[(0,o.Wm)(P,{modelValue:e.isPartOfSubheader,"onUpdate:modelValue":t[3]||(t[3]=t=>e.isPartOfSubheader=t),label:"Is part of another question?"},null,8,["modelValue"]),(0,o.Wm)(_,{outlined:"",modelValue:e.questionDescription,"onUpdate:modelValue":t[4]||(t[4]=t=>e.questionDescription=t),label:"Description",hint:"ex: What industry do you belong in? "},null,8,["modelValue"]),(0,o.Wm)(_,{outlined:"",modelValue:e.questionLabel,"onUpdate:modelValue":t[5]||(t[5]=t=>e.questionLabel=t),label:"Label",hint:"What will be the hint for this question"},null,8,["modelValue"]),(0,o.Wm)(x,{outlined:"",modelValue:e.questionType,"onUpdate:modelValue":t[6]||(t[6]=t=>e.questionType=t),options:e.questionTypes,"option-label":"description",label:"Question Type",hint:"ex: Text, select-drop for dropdown, etc","emit-value":"","map-options":""},null,8,["modelValue","options"]),e.isPartOfSubheader?((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(x,{outlined:"",modelValue:e.partOfSubheader,"onUpdate:modelValue":t[7]||(t[7]=t=>e.partOfSubheader=t),options:e.subHeadersQuestions,"option-value":"id","option-label":"description",label:"Which question to be included to",hint:"ex: Please rate the following questions - Timeliness"},null,8,["modelValue","options"])])):(0,o.kq)("",!0),(0,o.Wm)(_,{"lazy-rules":"",rules:[e=>!!e||"Field is required",e=>!isNaN(e)||"Field should be a number",e=>e>0||"Field should be a positive number"],outlined:"",modelValue:e.position,"onUpdate:modelValue":t[8]||(t[8]=t=>e.position=t),label:"Position",type:"number",hint:"Position/Order in the survey form"},null,8,["rules","modelValue"])])])),_:1}),(0,o.Wm)(C,{align:"right",class:"text-primary"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(Q,{flat:"",label:"Cancel"},null,512),[[U]]),(0,o.Wm)(Q,{flat:"",type:"submit",label:"Add Question"})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])):(0,o.kq)("",!0)])),_:1},8,["modelValue"]),(0,o.Wm)(S,{modelValue:e.updateQuestionModal,"onUpdate:modelValue":t[16]||(t[16]=t=>e.updateQuestionModal=t)},{default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,o.Wm)(T,{ref:"updateQuestionForm",onSubmit:e.onSubmitUpdateQuestion},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{style:{"min-width":"500px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{class:"bg-primary text-white"},{default:(0,o.w5)((()=>[c])),_:1}),(0,o.Wm)(k,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o._)("div",m,[(0,o.Wm)(_,{outlined:"",modelValue:e.updateDescription,"onUpdate:modelValue":t[10]||(t[10]=t=>e.updateDescription=t),label:"Description",hint:"ex: What industry do you belong in? "},null,8,["modelValue"]),(0,o.Wm)(_,{outlined:"",modelValue:e.updateLabel,"onUpdate:modelValue":t[11]||(t[11]=t=>e.updateLabel=t),label:"Label",hint:"What will be the hint for this question"},null,8,["modelValue"]),(0,o.Wm)(x,{outlined:"",modelValue:e.updateParent,"onUpdate:modelValue":t[12]||(t[12]=t=>e.updateParent=t),options:e.subHeadersQuestions,"option-label":"description",label:"Parent",hint:"ex: Please rate the following questions - Timeliness","emit-value":"","map-options":""},null,8,["modelValue","options"]),5==e.updateQuestionType.id?((0,o.wg)(),(0,o.j4)(x,{key:0,outlined:"",modelValue:e.updateQuestionType,"onUpdate:modelValue":t[13]||(t[13]=t=>e.updateQuestionType=t),disable:"",readonly:"",options:e.questionTypes,"option-label":"description",label:"Question Type",disab:"",hint:"ex: Text, select-drop for dropdown, etc","emit-value":"","map-options":""},null,8,["modelValue","options"])):((0,o.wg)(),(0,o.j4)(x,{key:1,outlined:"",modelValue:e.updateQuestionType,"onUpdate:modelValue":t[14]||(t[14]=t=>e.updateQuestionType=t),options:e.questionTypes,"option-label":"description",label:"Question Type",disab:"",hint:"ex: Text, select-drop for dropdown, etc","emit-value":"","map-options":""},null,8,["modelValue","options"])),(0,o.Wm)(_,{"lazy-rules":"",rules:[e=>!!e||"Field is required",e=>!isNaN(e)||"Field should be a number",e=>e>0||"Field should be a positive number"],outlined:"",modelValue:e.updatePosition,"onUpdate:modelValue":t[15]||(t[15]=t=>e.updatePosition=t),label:"Position",type:"number",hint:"Position/Order in the survey form"},null,8,["rules","modelValue"])])])),_:1}),(0,o.Wm)(C,{align:"right",class:"text-primary"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(Q,{flat:"",label:"Cancel"},null,512),[[U]]),(0,o.Wm)(Q,{flat:"",type:"submit",label:"Update Question"})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])])),_:1},8,["modelValue"]),(0,o.Wm)(S,{modelValue:e.confirm,"onUpdate:modelValue":t[17]||(t[17]=t=>e.confirm=t)},{default:(0,o.w5)((()=>[e.confirm?((0,o.wg)(),(0,o.iD)("div",b,[(0,o.Wm)(D,{style:{"min-width":"350px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{class:"bg-primary text-white"},{default:(0,o.w5)((()=>[f])),_:1}),(0,o.Wm)(k,{class:"row items-center"},{default:(0,o.w5)((()=>[y])),_:1}),(0,o.Wm)(k,{class:"row items-center"},{default:(0,o.w5)((()=>[(0,o._)("p",v,"Question: "+(0,i.zw)(e.deleteQuestionDescription)+" with the ID "+(0,i.zw)(e.toDelete),1)])),_:1}),(0,o.Wm)(C,{align:"right"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(Q,{flat:"",label:"Cancel",color:"primary"},null,512),[[U]]),(0,o.wy)((0,o.Wm)(Q,{flat:"",label:"Delete",onClick:e.confirmDelete,color:"red"},null,8,["onClick"]),[[U]])])),_:1})])),_:1})])):(0,o.kq)("",!0)])),_:1},8,["modelValue"]),e.error?((0,o.wg)(),(0,o.iD)("p",h)):(0,o.kq)("",!0)])}l(10071);var g=l(48825),q=l(61959),Q=l(26873),V=l(24334),_=l.n(V);const W=[{name:"id",label:"Id",field:e=>e.id,sortable:!0,align:"left"},{name:"description",label:"Description",align:"left",field:e=>e.description,sortable:!0},{name:"question_type",label:"Question_type",align:"left",field:e=>e.question_type.description},{name:"position",label:"Position",align:"left",field:e=>e.position,sortable:!0},{name:"action",label:"Action",align:"left",field:""}],H=(0,o.aZ)({name:"QuestionsPage",setup(){const e=(0,g.Z)(),t=(0,q.iH)(null),l=(0,q.iH)([]),i=(0,q.iH)([]),a=(0,q.iH)(null),n=(0,q.iH)(!1),u=(0,q.iH)(!1),s=(0,q.iH)(!1),d=((0,q.iH)(""),(0,q.iH)("position")),r=(0,q.iH)(""),p=(0,q.iH)(""),c=(0,q.iH)(null),m=(0,q.iH)([]),b=(0,q.iH)(""),f=(0,q.iH)([]),y=(0,q.iH)([]),v=(0,q.iH)(null),h=(0,q.iH)(null),w=(0,q.iH)(!1),V=(0,q.iH)(null),H=(0,q.iH)(""),k=(0,q.iH)(""),P=(0,q.iH)(""),x=(0,q.iH)(null),C=(0,q.iH)(null),D=(0,q.iH)(null),T=(0,q.iH)(null),S=(0,q.iH)([]),U=(0,q.iH)(""),F=(0,q.iH)(!0),Z=(0,q.iH)({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:10});function L(){n.value=!0,Y()}function O(e){s.value=!0,H.value=e.row.description,C.value=e.row.question_type,k.value=e.row.label,P.value=e.row.position,x.value=e.row.parent,T.value=e.row.id,Y()}function A(){const t={description:"",question_type:{},position:0,label:"",parent:{}};D.value.validate().then((l=>{l?(e.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Submitted"}),t.description=H.value,t.position=P.value,t.question_type=C.value,t.label=k.value,t.parent=x.value,(0,Q.Ds)(T.value,t),s.value=!1,R({pagination:Z.value,filter:void 0})):e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Please check the fields and change appropriy"})}))}function M(e){u.value=!0,v.value=e.row.id,h.value=e.row.description}function N(){(0,Q.Lk)(v.value),e.notify({color:"blue-4",textColor:"white",icon:"cloud_done",message:"Deleted"}),R({pagination:Z.value,filter:void 0})}function I(){const l={description:"",question_type:{id:"",description:""},position:0,label:"",parent:{}};t.value.validate().then((t=>{t?(e.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Submitted"}),l.description=r.value,l.position=p.value,l.question_type.id=c.value.id,l.question_type.description=c.value.description,l.label=b.value,w.value&&(l.parent=V.value),(0,Q.$O)(l),n.value=!1,R({pagination:Z.value,filter:void 0})):e.notify({color:"red-5",textColor:"white",icon:"warning",message:"Please check the fields and change appropriy"})}))}(0,o.YP)(w,((e,t)=>{V.value=""})),(0,o.YP)(u,((e,t)=>{u.value||(v.value="")}));const z=async()=>{try{let e=[];return e=await(0,Q.tI)(),e=_()(e,d.value),f.value=e.reduce((function(e,t){return 5==t.question_type.id&&e.push(t),e}),[]),e}catch(e){throw e}};function j(e){if(!e)return l.value.length;let t=0;return l.value.forEach((l=>{l.description.toLowerCase(),l.description.includes(e)&&++t})),t}function B(e,t,o,i,a){const n=o?l.value.filter((e=>e.description.includes(o))):l.value.slice();if(i){const e="desc"===i?a?(e,t)=>e.name>t.name?-1:e.name<t.name?1:0:(e,t)=>e.name>t.name?1:e.name<t.name?-1:0:a?(e,t)=>parseFloat(t[i])-parseFloat(e[i]):(e,t)=>parseFloat(e[i])-parseFloat(t[i]);n.sort(e)}return n.slice(e,e+t)}async function R(e){const{page:t,rowsPerPage:o,sortBy:i,descending:a}=e.pagination,n=e.filter;F.value=!0,setTimeout((async()=>{l.value=await z(),Z.value.rowsNumber=j(n);const e=0===o?Z.value.rowsNumber:o,u=(t-1)*o,s=B(u,e,n,i,a);S.value.splice(0,S.value.length,...s),Z.value.page=t,Z.value.rowsPerPage=o,Z.value.sortBy=i,Z.value.descending=a,F.value=!1}),2e3)}const Y=async()=>{try{const e=await(0,Q.iv)(),t=e.map((({published_at:e,submittedAt:t,updated_at:l,questions:o,...i})=>i));i.value=t}catch(e){throw e}};return(0,o.bv)((()=>{R({pagination:Z.value,filter:void 0})})),{isPartOfSubheader:w,questions:l,questionTypes:i,loading:F,error:a,getQuestionsWithSubheaderFromApi:z,columns:W,addQuestionModal:n,addQuestionClick:L,deleteQuestion:M,editQuestion:O,questionDescription:r,questionType:c,questionSubheader:m,questionLabel:b,position:p,onSubmit:I,questionForm:t,subHeadersQuestions:f,partOfSubheader:V,includedQuestions:y,confirm:u,confirmDelete:N,toDelete:v,deleteQuestionDescription:h,updateQuestionModal:s,updateDescription:H,updateLabel:k,updatePosition:P,updateParent:x,updateQuestionType:C,onSubmitUpdateQuestion:A,updateQuestionForm:D,filter:U,onRequest:R,pagination:Z,rows:S}}});var k=l(2165),P=l(17132),x=l(64689),C=l(24554),D=l(83884),T=l(46778),S=l(68689),U=l(10151),F=l(25589),Z=l(28886),L=l(63314),O=l(99367),A=l(60677),M=l(7518),N=l.n(M);H.render=w;const I=H;N()(H,"components",{QBtn:k.Z,QTable:P.Z,QInput:x.Z,QIcon:C.Z,QTd:D.Z,QDialog:T.Z,QForm:S.Z,QCard:U.Z,QCardSection:F.Z,QToggle:Z.Z,QSelect:L.Z,QCardActions:O.Z}),N()(H,"directives",{ClosePopup:A.Z})}}]);